{"version":"1.128.1","results":[{"check_id":"dockerfile.security.missing-user.missing-user","path":"backend1/backend1.Dockerfile","start":{"line":22,"col":1,"offset":276},"end":{"line":22,"col":31,"offset":306},"extra":{"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nCMD [\"sh\", \"-c\", \"yarn start\"]","metadata":{"cwe":["CWE-250: Execution with Unnecessary Privileges"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","shortlink":"https://sg.run/Gbvn"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"problem-based-packs.insecure-transport.js-node.bypass-tls-verification.bypass-tls-verification","path":"backend1/src/db/knexfile.ts","start":{"line":34,"col":12,"offset":786},"end":{"line":34,"col":41,"offset":815},"extra":{"message":"Checks for setting the environment variable NODE_TLS_REJECT_UNAUTHORIZED to 0, which disables TLS verification. This should only be used for debugging purposes. Setting the option rejectUnauthorized to false bypasses verification against the list of trusted CAs, which also leads to insecure transport. These options lead to vulnerability to MTM attacks, and should not be used.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","category":"security","cwe":"CWE-319: Cleartext Transmission of Sensitive Information","owasp":"A03:2017 - Sensitive Data Exposure","references":["https://nodejs.org/api/https.html#https_https_request_options_callback","https://stackoverflow.com/questions/20433287/node-js-request-cert-has-expired#answer-29397100"],"subcategory":["vuln"],"technology":["node.js"],"vulnerability":"Insecure Transport","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Mishandled Sensitive Information"],"source":"https://semgrep.dev/r/problem-based-packs.insecure-transport.js-node.bypass-tls-verification.bypass-tls-verification","shortlink":"https://sg.run/9oxr"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"problem-based-packs.insecure-transport.js-node.bypass-tls-verification.bypass-tls-verification","path":"backend2/src/db/knexfile.ts","start":{"line":33,"col":12,"offset":770},"end":{"line":33,"col":41,"offset":799},"extra":{"message":"Checks for setting the environment variable NODE_TLS_REJECT_UNAUTHORIZED to 0, which disables TLS verification. This should only be used for debugging purposes. Setting the option rejectUnauthorized to false bypasses verification against the list of trusted CAs, which also leads to insecure transport. These options lead to vulnerability to MTM attacks, and should not be used.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","category":"security","cwe":"CWE-319: Cleartext Transmission of Sensitive Information","owasp":"A03:2017 - Sensitive Data Exposure","references":["https://nodejs.org/api/https.html#https_https_request_options_callback","https://stackoverflow.com/questions/20433287/node-js-request-cert-has-expired#answer-29397100"],"subcategory":["vuln"],"technology":["node.js"],"vulnerability":"Insecure Transport","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Mishandled Sensitive Information"],"source":"https://semgrep.dev/r/problem-based-packs.insecure-transport.js-node.bypass-tls-verification.bypass-tls-verification","shortlink":"https://sg.run/9oxr"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"dockerfile.security.missing-user.missing-user","path":"frontend/frontend.Dockerfile","start":{"line":35,"col":1,"offset":583},"end":{"line":35,"col":35,"offset":617},"extra":{"message":"By not specifying a USER, a program in the container may run as 'root'. This is a security hazard. If an attacker can control a process running as root, they may have control over the container. Ensure that the last USER in a Dockerfile is a USER other than 'root'.","fix":"USER non-root\nCMD [\"nginx\", \"-g\", \"daemon off;\"]","metadata":{"cwe":["CWE-250: Execution with Unnecessary Privileges"],"category":"security","technology":["dockerfile"],"confidence":"MEDIUM","owasp":["A04:2021 - Insecure Design"],"references":["https://owasp.org/Top10/A04_2021-Insecure_Design"],"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authorization"],"source":"https://semgrep.dev/r/dockerfile.security.missing-user.missing-user","shortlink":"https://sg.run/Gbvn"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"javascript.browser.security.insecure-document-method.insecure-document-method","path":"frontend/src/util.tsx","start":{"line":27,"col":5,"offset":776},"end":{"line":27,"col":34,"offset":805},"extra":{"message":"User controlled data in methods like `innerHTML`, `outerHTML` or `document.write` is an anti-pattern that can lead to XSS vulnerabilities","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"category":"security","technology":["browser"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"LOW","references":["https://owasp.org/Top10/A03_2021-Injection"],"license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/javascript.browser.security.insecure-document-method.insecure-document-method","shortlink":"https://sg.run/LwA9"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["backend1/.dockerignore","backend1/.editorconfig","backend1/.env.example","backend1/.gitignore","backend1/README.md","backend1/backend1.Dockerfile","backend1/nodemon.json","backend1/package-lock.json","backend1/package.json","backend1/src/constants/user.ts","backend1/src/controllers/userController.ts","backend1/src/db/README.md","backend1/src/db/knex.ts","backend1/src/db/knexfile.ts","backend1/src/db/migrations/20250610165607_create_user_table.ts","backend1/src/domain/User.ts","backend1/src/enums/user.ts","backend1/src/index.ts","backend1/src/maps/user.ts","backend1/src/middlewares/errorHandler.ts","backend1/src/middlewares/errorLogging.ts","backend1/src/middlewares/logger.ts","backend1/src/middlewares/loggingMiddleware.ts","backend1/src/middlewares/notFound.ts","backend1/src/models/README.md","backend1/src/models/UserModel.ts","backend1/src/routes/index.ts","backend1/src/routes/userRoutes.ts","backend1/src/schemas/README.md","backend1/src/services/userService.ts","backend1/src/types/README.md","backend1/src/utils/README.md","backend1/tsconfig.json","backend1/tslint.json","backend1/yarn.lock","backend2/.dockerignore","backend2/.editorconfig","backend2/.env.example","backend2/.gitignore","backend2/README.md","backend2/backend2.Dockerfile","backend2/nodemon.json","backend2/package.json","backend2/src/constants/user.ts","backend2/src/controllers/blogController.ts","backend2/src/controllers/commentController.ts","backend2/src/db/README.md","backend2/src/db/knex.ts","backend2/src/db/knexfile.ts","backend2/src/db/migrations/20250610174857_create_blogs_table.ts","backend2/src/db/migrations/20250610174904_create_comments_table.ts","backend2/src/domain/Blog.ts","backend2/src/enums/user.ts","backend2/src/index.ts","backend2/src/maps/user.ts","backend2/src/middlewares/errorHandler.ts","backend2/src/middlewares/errorLogging.ts","backend2/src/middlewares/logger.ts","backend2/src/middlewares/notFound.ts","backend2/src/models/BlogModel.ts","backend2/src/models/CommentModel.ts","backend2/src/models/README.md","backend2/src/routes/blogRoutes.ts","backend2/src/routes/commentRoutes.ts","backend2/src/routes/index.ts","backend2/src/schemas/README.md","backend2/src/services/BlogService.ts","backend2/src/services/CommentService.ts","backend2/src/types/README.md","backend2/src/utils/README.md","backend2/tsconfig.json","backend2/tslint.json","backend2/yarn.lock","frontend/.dockerignore","frontend/.env.example","frontend/.gitignore","frontend/README.md","frontend/build.sh","frontend/entrypoint.sh","frontend/eslint.config.js","frontend/frontend.Dockerfile","frontend/index.html","frontend/nginx.conf","frontend/package.json","frontend/public/vite.svg","frontend/src/App.css","frontend/src/App.tsx","frontend/src/assets/react.svg","frontend/src/hooks/useBlogData.tsx","frontend/src/index.css","frontend/src/main.tsx","frontend/src/pages/AllBlogs.tsx","frontend/src/pages/CompleteSignup.tsx","frontend/src/pages/CreateBlog.tsx","frontend/src/pages/Editor.tsx","frontend/src/pages/SingleBlog.tsx","frontend/src/util.tsx","frontend/src/vite-env.d.ts","frontend/tsconfig.app.json","frontend/tsconfig.json","frontend/tsconfig.node.json","frontend/vite.config.ts","frontend/yarn.lock"]},"time":{"rules":[],"rules_parse_time":1.3824009895324707,"profiling_times":{"config_time":3.7881946563720703,"core_time":2.7029495239257812,"ignores_time":0.001512765884399414,"total_time":6.493192434310913},"parsing_time":{"total_time":0.23874616622924805,"per_file_time":{"mean":0.0033626220595668736,"std_dev":8.231344213734819e-05},"very_slow_files":[]},"targets":[],"total_bytes":0,"max_memory_bytes":1087023296},"skipped_rules":[]}